"use strict";$(function(){$("#quanbu").hover(function(){$("#fenlei").css("display","block")},function(){$("#fenlei").css("display","block")}),$("#fenlei").hover(function(){$("#fenlei").css("display","block")},function(){$("#fenlei").css("display","block")});var a=decodeURI(location.search).slice(1).split("-"),t=0,e=12,o=0,s=1,g=0,l="",c=[],u=1e3,h="",n="",p=!0,r=!1;if("品类"==a?l="fenlei2":"品牌"==a?l="pinpai":"价格"==a?l="jiage3":"净含量"==a?l="hanliang2":"包装"==a&&(l="baozhang"),1==a.length){var i="jiekou=sousuo&mingcheng="+a[0]+"&tiao="+t+"&tiao2="+e,m="jiekou=sousuo&mingcheng="+a[0]+"&tiao=0&tiao2=1000";d(i),f(m),$(".list-1").get(0).innerHTML+='<i>〉</i><a href="">'+a[0]+"</a>"}else{i="jiekou=sousuo&mingcheng="+a[0]+"&leixing="+l+"&mingcheng2="+a[2]+"&tiao="+t+"&tiao2="+e,m="jiekou=sousuo&mingcheng="+a[0]+"&leixing="+l+"&mingcheng2="+a[2]+"&tiao=0&tiao2=1000";d(i),f(m),$(".list-1").get(0).innerHTML+='<i>〉</i><a href="">'+a[0]+"</a>",$(".list-1").get(0).innerHTML+='<i>〉</i><a href="">'+a[2]+"</a>"}function f(i){$.ajax({type:"POST",url:"../api/api.php",data:i,success:function(i){var n=JSON.parse(i);o=n.length,g=Math.ceil(o/12),j(s,g,o);for(var a=0;a<n.length;a++)-1==c.indexOf(n[a].pinpai)&&(c.push(n[a].pinpai),$("#pinpai").get(0).innerHTML+='<span><input type="checkbox"><i>'+n[a].pinpai+"</i></span>")}})}function j(i,n,a){$("#yeshu").html("第"+i+"页， 共 "+n+" 页 [共"+a+"件商品]"),$("#ye").html(i),$("#ye2").html(n),$("#jianshu").html("共"+a+"件商品"),$("#yeshu2").html(" ");for(var t=1;t<=n;t++)$("#yeshu2").get(0).innerHTML+=1==t?'<a class="jiaodian" href="javascript:;">'+t+"</a>":'<a href="javascript:;">'+t+"</a>";$("#yeshu2 a").attr("class",""),$("#yeshu2 a").eq(i-1).attr("class","jiaodian")}function d(i){$.ajax({type:"POST",url:"../api/api.php",data:i,success:function(i){var n,a=JSON.parse(i);if(console.log(a),0==u)for(var t=0;t<a.length;t++)a[t].pinpai==h&&(o=0,e(t));if(1==u)for(t=0;t<a.length;t++)a[t].jiage3==h&&(o=0,e(t));if(2==u)for(t=0;t<a.length;t++)a[t].hanliang2==h&&(o=0,e(t));if(3==u)for(t=0;t<a.length;t++)a[t].baozhuang==h&&(o=0,e(t));function e(i){o++,$("#list-conter").get(0).innerHTML+='<li data-id="'+a[i].id+'">\n                <img src="../img/list-img/'+a[i].img+'" alt="">\n                <p>'+a[i].name+"</p>\n                <p>¥ "+a[i].jiage1+".00</p>\n                <p><span>市场价 ¥"+a[i].jiage2+".00</span><span><i>"+a[i].pinglun+'</i>人评论</span></p>\n                <p><a href="javascript:;" class="goumai">立即购买</a><a href="javascript:;" class="jiagouwu">加入购物车</a></p>\n            </li>'}1e3==u&&(n=a.map(function(i){return'<li data-id="'+i.id+'">\n                    <img src="../img/list-img/'+i.img+'" alt="">\n                    <p class="name">'+i.name+"</p>\n                    <p>¥ "+i.jiage1+".00</p>\n                    <p><span>市场价 ¥"+i.jiage2+".00</span><span><i>"+i.pinglun+'</i>人评论</span></p>\n                    <p><a href="javascript:;" class="goumai">立即购买</a><a href="javascript:;" class="jiagouwu">加入购物车</a></p>\n                </li>'}).join(" "),$("#list-conter").html(n)),g=Math.ceil(o/12),j(s,g,o)}})}$.ajax({type:"POST",url:"../api/api.php",data:"jiekou=sousuo&mingcheng="+a[0]+"&tiao=0&tiao2=10",success:function(i){var n=JSON.parse(i).map(function(i){return'<li>\n                    <div id="bangdan-l"><img src="../img/list-img/'+i.img+'" alt=""></div>\n                    <div id="bangdan-r">\n                        <p>'+i.name+"</p>\n                        <p><span>¥"+i.jiage1+".00</span><span>¥"+i.jiage2+".00</span></p>\n                    </div>\n                </li>"}).join(" ");$("#bangdan2").html(n)}});var k=a[0]+"热销TOP10",x=a[0]+" - 商品筛选";function v(i){1==a.length?d(1==r?"jiekou=sousuo&mingcheng="+a[0]+"&tiao="+i+"&tiao2="+e+"&paixun="+n+"&shengjiang="+p:"jiekou=sousuo&mingcheng="+a[0]+"&tiao="+i+"&tiao2="+e):d(1==r?"jiekou=sousuo&mingcheng="+a[0]+"&leixing="+l+"&mingcheng2="+a[2]+"&tiao="+i+"&tiao2="+e+"&paixun="+n+"&shengjiang="+p:"jiekou=sousuo&mingcheng="+a[0]+"&leixing="+l+"&mingcheng2="+a[2]+"&tiao="+i+"&tiao2="+e)}function y(i,n){($("#list-conter").html(" "),1==a.length)?d("jiekou=sousuo&mingcheng="+a[0]+"&tiao="+t+"&tiao2="+e+"&paixun="+i+"&shengjiang="+n):d("jiekou=sousuo&mingcheng="+a[0]+"&leixing="+l+"&mingcheng2="+a[2]+"&tiao="+t+"&tiao2="+e+"&paixun="+i+"&shengjiang="+n)}$("#bangdan").html(k),$("#saixuan").html(x),$("#yeshu2").on("click","a",function(){$("#list-conter").html(" "),s=$(this).index()+1,v(t=12*(s-1))}),$("#shang").click(function(){$("#list-conter").html(" "),1<s&&(s--,v(t-=12))}),$("#xia").click(function(){$("#list-conter").html(" "),s<g&&(s++,v(t+=12))}),$("#xuanze").on("click","input",function(){($("#xuanze input").prop("checked",!1),$("#list-conter").html(" "),$("#yeshu2").html(" "),$(this).get(0).checked=!0,j(s=1,g=1,o=0),h=$(this).next().html(),u=$(this).parent().parent().index(),1==a.length)?d("jiekou=sousuo&mingcheng="+a[0]+"&tiao="+t+"&tiao2="+e):d("jiekou=sousuo&mingcheng="+a[0]+"&leixing="+l+"&mingcheng2="+a[2]+"&tiao="+t+"&tiao2="+e)}),$("#qingkong").click(function(){if(u=1e3,$("#xuanze input").prop("checked",!1),$("#list-conter").html(" "),$("#yeshu2").html(" "),1==a.length){var i="jiekou=sousuo&mingcheng="+a[0]+"&tiao="+t+"&tiao2="+e,n="jiekou=sousuo&mingcheng="+a[0]+"&tiao=0&tiao2=1000";d(i),f(n)}else{i="jiekou=sousuo&mingcheng="+a[0]+"&leixing="+l+"&mingcheng2="+a[2]+"&tiao="+t+"&tiao2="+e,n="jiekou=sousuo&mingcheng="+a[0]+"&leixing="+l+"&mingcheng2="+a[2]+"&tiao=0&tiao2=1000";d(i),f(n)}}),$("#jia").click(function(){p?$("#jia").html('价格<img src="../img/list-img/tubiao/list_ico3a.png" alt="">'):$("#jia").html('价格<img src="../img/list-img/tubiao/list_ico4a.png" alt="">'),r=!0,y(n="jiage1",p=!p)}),$("#han").click(function(){p?$("#han").html('含量<img src="../img/list-img/tubiao/list_ico3a.png" alt="">'):$("#han").html('含量<img src="../img/list-img/tubiao/list_ico4a.png" alt="">'),r=!0,y(n="hanliang",p=!p)}),$("#ping").click(function(){p?$("#ping").html('评论<img src="../img/list-img/tubiao/list_ico3a.png" alt="">'):$("#ping").html('评论<img src="../img/list-img/tubiao/list_ico4a.png" alt="">'),r=!0,y(n="pinglun",p=!p)}),$("#list-conter").on("click","img",function(){var i=$(this).parent().get(0).dataset.id;location.href="../html/detail.html?"+i}),$("#list-conter").on("click",".name",function(){var i=$(this).parent().get(0).dataset.id;location.href="../html/detail.html?"+i,console.log(111)}),$("#list-conter").on("click",".goumai",function(){var i=$(this).parent().parent().get(0).dataset.id,n=document.cookie.split("="),a=n[1];2<=n.length?$.ajax({type:"POST",url:"../api/api.php",data:"jiekou=jiagouwu&user="+a+"&id="+i+"&shuliang=1",success:function(i){"true"==i?location.href="shopping.html":alert("加入购物车失败")}}):alert("你还未登陆")}),$("#list-conter").on("click",".jiagouwu",function(){var i=$(this).parent().parent().get(0).dataset.id,n=document.cookie.split("="),a=n[1];2<=n.length?$.ajax({type:"POST",url:"../api/api.php",data:"jiekou=jiagouwu&user="+a+"&id="+i+"&shuliang=1",success:function(i){"true"==i?alert("加入购物车成功"):alert("加入购物车失败")}}):alert("你还未登陆")})});